(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d9a47b70"],{"0930":function(e,t,n){"use strict";n("2e66")},"2e66":function(e,t,n){},"95a3":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tokenTransfer"},[n("RainbowPanel",{directives:[{name:"show",rawName:"v-show",value:0==e.activeIndex,expression:"activeIndex==0"}],scopedSlots:e._u([{key:"name",fn:function(){return[n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("span",{staticStyle:{"font-size":"18px"}},[e._v("我的RBT-deposit "),n("span",{staticClass:"erc-info"},[e._v("ERC721")])]),n("el-button",{staticClass:"button-view",attrs:{size:"mini"},on:{click:function(t){e.isShowRecord=!0}}},[e._v(" 已过期 ")])],1)]},proxy:!0},{key:"content",fn:function(){return e._l(e.bankTokenArr,(function(t){return n("div",{key:t.index},[n("TableItem",{attrs:{tableData:t,operateRName:"取款"},on:{operateRClick:e.operateRClick}})],1)}))},proxy:!0}])}),n("RainbowPanel",{directives:[{name:"show",rawName:"v-show",value:1==e.activeIndex,expression:"activeIndex==1"}],scopedSlots:e._u([{key:"name",fn:function(){return[e._v(" 令牌转让市场 ")]},proxy:!0},{key:"content",fn:function(){return[n("el-table",{attrs:{data:e.marketTokenArr.slice((e.currentPage-1)*e.pagesize,e.currentPage*e.pagesize)}},[n("el-table-column",{attrs:{label:"#",type:"index"}}),n("el-table-column",{attrs:{prop:"firstOwnerName",label:"初始生成人"}}),n("el-table-column",{attrs:{label:"生成时间"},scopedSlots:e._u([{key:"default",fn:function(t){return n("div",{},[e._v(" "+e._s(e._f("formatDate")(new Date(1e3*t.row.creationTime)))+" ")])}}])}),n("el-table-column",{attrs:{label:"到期时间"},scopedSlots:e._u([{key:"default",fn:function(t){return n("div",{},[e._v(" "+e._s(e._f("formatDate")(new Date(1e3*t.row.expireTime)))+" ")])}}])}),n("el-table-column",{attrs:{prop:"expireTime",label:"剩余天数"},scopedSlots:e._u([{key:"default",fn:function(t){return n("div",{},[e._v(" "+e._s(parseInt((t.row.expireTime-t.row.creationTime)/86400))+" ")])}}])}),n("el-table-column",{attrs:{prop:"mortgageAmount",label:"包含RBT数量"},scopedSlots:e._u([{key:"default",fn:function(t){return n("div",{},[e._v(" "+e._s(e._f("formatNumberTo")(t.row.mortgageAmount))+" ")])}}])}),n("el-table-column",{attrs:{prop:"usedAmount",label:"生成社区治理令牌总额度"},scopedSlots:e._u([{key:"default",fn:function(t){return n("div",{},[e._v(" "+e._s(e._f("formatNumberTo")(t.row.usedAmount))+" ")])}}])},[n("template",{slot:"header"},[n("div",{staticStyle:{"text-align":"center"}},[e._v(" 生成社区"),n("br"),e._v("治理令牌总额度 ")])])],2),n("el-table-column",{attrs:{label:""},scopedSlots:e._u([{key:"default",fn:function(t){return n("div",{},[e._v(" "+e._s(e._f("formatNumberTo")(t.row.mortgageAmount-t.row.usedAmount))+" ")])}}])},[n("template",{slot:"header"},[n("div",{staticStyle:{"text-align":"center"}},[e._v(" 目前还可"),n("br"),e._v("生成令牌总额度 ")])])],2),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{staticClass:"button1",attrs:{size:"mini"},on:{click:function(n){return e.buyDeposit(t.row)}}},[e._v(" 购买 ")])]}}])})],1),n("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,20,40],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.marketTokenArr.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})]},proxy:!0}])}),n("el-dialog",{attrs:{title:"发布出售令牌信息",visible:e.isShowPublish,width:"400px"},on:{"update:visible":function(t){e.isShowPublish=t}}},[n("div",{staticClass:"order"},[n("div",{staticClass:"r-intro-box"},[n("div",[n("span",[e._v("编号")]),n("span",[e._v(e._s(e.sellToken.tokenId))])]),n("div",[n("span",[e._v("生成日期")]),n("span",[e._v(" "+e._s(e._f("formatDate")(new Date(1e3*e.sellToken.creationTime))))])]),n("div",[n("span",[e._v("到期时间")]),n("span",[e._v(" "+e._s(e._f("formatDate")(new Date(1e3*e.sellToken.expireTime))))])]),n("div",[n("span",[e._v("剩余天数")]),n("span",[e._v(e._s(parseInt((e.sellToken.expireTime-e.sellToken.creationTime)/86400)))])]),n("div",[n("span",[e._v("包含RBT数量")]),n("span",[e._v(" "+e._s(e._f("formatNumber")(e.sellToken.mortgageAmount)))])]),n("div",[n("span",[e._v("包含RBT价值")]),n("span",[e._v(" $"+e._s(e._f("formatNumber")(e.includeValue)))])]),n("div",[n("span",[e._v("已使用社区治理令牌额度")]),n("span",[e._v(" "+e._s(e._f("formatNumber")(e.sellToken.usedAmount)))])]),n("div",[n("span",[e._v("剩余社区治理令牌额度")]),n("span",[e._v(e._s(e._f("formatNumber")(e.sellToken.mortgageAmount-e.sellToken.usedAmount)))])])]),n("div",{staticClass:"price-box"},[n("span",[e._v("出售金额")]),n("div",{staticClass:"input-box"},[n("el-input",{staticClass:"input2",attrs:{size:"mini"},model:{value:e.orderForm.amount,callback:function(t){e.$set(e.orderForm,"amount",t)},expression:"orderForm.amount"}}),n("ChooseToken",{on:{changeToken:e.changeToken}})],1)]),n("div",{staticClass:"intro"},[e._v(" 出售成功后，将扣除您 "),n("span",{staticClass:"r-p-color"},[e._v("5%")]),e._v("的平台服务费 ")]),n("div",{staticClass:"operating"},[n("el-button",{staticClass:"button3",attrs:{size:"small"},on:{click:function(t){e.isShowPublish=!1}}},[e._v("Cancel")]),n("el-button",{staticClass:"button1",attrs:{size:"small "},on:{click:e.subOrder}},[e._v("确认出售")])],1)])]),n("el-dialog",{attrs:{title:"购买令牌确认",visible:e.isShowBuy,width:"400px"},on:{"update:visible":function(t){e.isShowBuy=t}}},[n("div",{staticClass:"order"},[n("div",{staticClass:"r-intro-box"},[n("div",[n("span",[e._v("编号")]),n("span",[e._v(e._s(e.buyToken.tokenId))])]),n("div",[n("span",[e._v("生成日期")]),n("span",[e._v(" "+e._s(e._f("formatDate")(new Date(1e3*e.buyToken.creationTime))))])]),n("div",[n("span",[e._v("到期时间")]),n("span",[e._v(" "+e._s(e._f("formatDate")(new Date(1e3*e.buyToken.expireTime))))])]),n("div",[n("span",[e._v("剩余天数")]),n("span",[e._v(e._s(parseInt((e.buyToken.expireTime-e.buyToken.creationTime)/86400)))])]),n("div",[n("span",[e._v("包含RBT数量")]),n("span",[e._v(" "+e._s(e._f("formatNumberTo")(e.buyToken.mortgageAmount)))])]),n("div",[n("span",[e._v("包含RBT价值")]),n("span",[e._v(" $"+e._s(e._f("formatNumberTo")(e.buyToken.mortgageAmount)))])]),n("div",[n("span",[e._v("已使用社区治理令牌额度")]),n("span",[e._v(" "+e._s(e._f("formatNumberTo")(e.buyToken.usedAmount)))])]),n("div",[n("span",[e._v("剩余社区治理令牌额度")]),n("span",[e._v(e._s(e._f("formatNumberTo")(e.buyToken.mortgageAmount-e.buyToken.usedAmount)))])])]),n("div",{staticClass:"operating"},[n("el-button",{staticClass:"button3",attrs:{size:"small"},on:{click:function(t){e.isShowBuy=!1}}},[e._v("Cancel")]),n("el-button",{staticClass:"button1",attrs:{size:"small "},on:{click:e.subBuy}},[e._v("确认购买")])],1)])])],1)},o=[],s=n("5530"),i=(n("159b"),n("2f62")),r=n("c1df"),l=n.n(r),u={name:"tokenTransfer",data:function(){return{currentPage:1,pagesize:5,orderForm:{},sellToken:{},buyToken:{},isShowPublish:!1,isShowBuy:!1,activeIndex:0,navList:[{name:"我的令牌",index:0},{name:"转让市场",index:1}]}},methods:{handleSizeChange:function(e){this.pagesize=e},handleCurrentChange:function(e){this.currentPage=e},sellDeposit:function(e){this.sellToken=e,this.isShowPublish=!0},buyDeposit:function(e){this.buyToken=e,this.isShowBuy=!0},changeToken:function(e){console.log(e)},subOrder:function(){var e=this;this.$store.dispatch("RbtDeposit721/approve",{to:"0x4D64eDac49B026aE95765DBD3830C582c693AEe4",tokenId:this.borrowToken.tokenId}).then((function(){e.publish()})).catch((function(){e.isLoading=!1,e.$message({type:"error",message:"授权失败"})}))},operateRClick:function(e){this.release(e.nameObj.data)},release:function(){},publish:function(){var e=this;this.isLoading=!1,this.$store.dispatch("transferMarket/publish",{amount:this.orderForm.amount,tokenId:this.sellToken.tokenId}).then((function(t){console.log(t),e.$message.success("发布成功"),e.orderForm={},e.isShowPublish=!1,e.getData()})).catch((function(t){console.log(t),e.$message.error("发布失败"+t),e.orderForm={}}))},subBuy:function(){var e=this;this.$store.dispatch("TokenExchangeMarket/bidToken",{from:"0x4D64eDac49B026aE95765DBD3830C582c693AEe4",id:1,bid:1e3,_types:"0x4D64eDac49B026aE95765DBD3830C582c693AEe4"}).then((function(t){console.log(t),e.$message.success("购买成功")})).catch((function(t){e.$message.error("购买失败"+t)}))},getData:function(){this.isConnected||this.$store.dispatch("RbtDeposit721/tokenMetadata",1),this.$store.dispatch("rainbowBank/getInfo"),this.$store.dispatch("TokenExchangeMarket/sellToken",{from:"0x4D64eDac49B026aE95765DBD3830C582c693AEe4",tokenId:1,sellPrice:1e3,_types:"0x4D64eDac49B026aE95765DBD3830C582c693AEe4"})}},created:function(){this.getData()},watch:{account:function(){this.getData()}},computed:Object(s["a"])(Object(s["a"])({},Object(i["b"])(["isConnected","account"])),{},{bankTokenArr:function(){var e=[];return this.$store.state.rainbowBank.records.forEach((function(t,n){e.push({index:n+1,nameObj:{title:"令牌编号",data:t.tokenId},infoArr:[{title:"锁仓类型",data:t.month+"个月"},{title:"包含RBT数量",data:t.amount},{title:"生成社区治理令牌总额度",data:""},{title:"目前还可以生成社区治理令牌额度",data:""}],detailArr:[{title:"初始生成人",data:t.depositor.substr(0,3)+"..."+t.depositor.substr(t.depositor.length-3,3)},{title:"现在所有人",data:t.depositor.substr(0,3)+"..."+t.depositor.substr(t.depositor.length-3,3)},{title:"生成时间",data:l()(t.created_at).format("YYYY-MM-DD")},{title:"到期时间",data:l()(t.updated_at).format("YYYY-MM-DD")}],withdrawa:[{address:t.depositor,tokenid:t.tokenId}]})})),e},marketTokenArr:function(){var e=this,t=[];return this.$store.state.transferMarket.marketTokenArr.forEach((function(n){for(var a=0;a<e.$store.state.rbtDeposit.bankTokenArr.length;a++){var o=e.$store.state.rbtDeposit.bankTokenArr[a];o.tokenId==n.tokenId&&t.push(Object(s["a"])(Object(s["a"])({},o),n))}})),t},includeValue:function(){return this.sellToken.mortgageAmount}})},c=u,d=(n("0930"),n("2877")),p=Object(d["a"])(c,a,o,!1,null,"40347197",null);t["default"]=p.exports}}]);
//# sourceMappingURL=chunk-d9a47b70.3d47d3b9.js.map